<!DOCTYPE html>
<html lang="en">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cyber Shooter with Integrated Questions</title>

<style>
body {
    margin: 0;
    background: #0e0e0e;
    font-family: Arial, sans-serif;
    color: white;
    text-align: center;
    overflow: hidden;
}

header {
    padding: 14px;
    background: #181818;
    font-size: 22px;
    border-bottom: 2px solid #333;
}

#scorePanel {
    margin: 10px;
    font-size: 18px;
}

button {
    padding: 10px 20px;
    background: #2b6aff;
    border: none;
    border-radius: 6px;
    color: white;
    font-size: 18px;
}

#gameArea {
    width: 100vw;
    height: 65vh;
    border: 2px solid #222;
    background: linear-gradient(#1b1b1b, #0d0d0d);
    position: relative;
    overflow: hidden;
}

.item {
    position: absolute;
    width: 65px;
    height: 65px;
    font-size: 40px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
}

.item.threat {
    background: #330000;
    border: 2px solid #ff4a4a;
}

.item.safe {
    background: #003300;
    border: 2px solid #33ff99;
}

#questionBox {
    position: absolute;
    top: 15vh;
    left: 50%;
    transform: translateX(-50%);
    width: 90%;
    max-width: 450px;
    padding: 20px;
    background: #111;
    border: 2px solid #2b6aff;
    border-radius: 10px;
    display: none;
    z-index: 9999;
}

.option {
    padding: 10px;
    margin-top: 8px;
    background: #222;
    border-radius: 6px;
    cursor: pointer;
}
.option:hover {
    background: #333;
}
</style>
</head>

<body>

<header>Cyber Security Shooter</header>

<div id="scorePanel">Score: 0 | Time: 30</div>
<button id="startBtn">Start Game</button>

<div id="gameArea"></div>

<div id="questionBox"></div>

<script>
let score = 0;
let timeLeft = 30;
let gameRunning = false;
let gameInterval;
let timerInterval;

// THREATS + QUESTIONS --------------  
const threatData = [
    {
        icon: "ü¶†",
        label: "Malware",
        q: "What is Malware?",
        options: ["A harmful software", "A secure server"],
        correct: 0
    },
    {
        icon: "üíÄ",
        label: "Ransomware",
        q: "What does Ransomware do?",
        options: ["Locks files for money", "Improves system speed"],
        correct: 0
    },
    {
        icon: "üêû",
        label: "Virus",
        q: "What is a computer virus?",
        options: ["Self-replicating threat", "Firewall software"],
        correct: 0
    },
    {
        icon: "‚ö†Ô∏è",
        label: "Phishing",
        q: "Phishing aims to:",
        options: ["Steal sensitive info", "Protect your identity"],
        correct: 0
    }
];

// SAFE Icons -----------------------
const safeIcons = ["üîí","üõ°Ô∏è","üîë","‚úîÔ∏è"];

document.getElementById("startBtn").onclick = startGame;

function startGame() {
    if (gameRunning) return;
    score = 0;
    timeLeft = 30;
    gameRunning = true;
    updatePanel();

    gameInterval = setInterval(spawnItem, 1000);
    timerInterval = setInterval(updateTimer, 1000);
}

function updatePanel() {
    document.getElementById("scorePanel").innerHTML = 
        `Score: ${score} | Time: ${timeLeft}`;
}

function updateTimer() {
    if (timeLeft <= 0) {
        endGame();
        return;
    }
    timeLeft--;
    updatePanel();
}

function spawnItem() {
    if (!gameRunning) return;

    const gameArea = document.getElementById("gameArea");
    const item = document.createElement("div");

    const isThreat = Math.random() < 0.65;
    
    let data;

    if (isThreat) {
        data = threatData[Math.floor(Math.random()*threatData.length)];
        item.dataset.question = JSON.stringify(data);
        item.innerHTML = data.icon;
        item.classList.add("item", "threat");
    } else {
        let icon = safeIcons[Math.floor(Math.random()*safeIcons.length)];
        item.innerHTML = icon;
        item.classList.add("item", "safe");
    }

    item.dataset.type = isThreat ? "threat" : "safe";

    item.style.left = Math.random() * (window.innerWidth - 80) + "px";
    item.style.top = "-80px";

    item.onclick = () => handleHit(item);

    gameArea.appendChild(item);

    let fall = setInterval(() => {
        if (!gameRunning) return;  
        item.style.top = (item.offsetTop + 4) + "px";

        if (item.offsetTop > window.innerHeight) {
            item.remove();
            clearInterval(fall);
        }
    }, 25);
}

// HANDLE HIT + SHOW QUESTION ------------------------
function handleHit(item) {
    if (!gameRunning) return;

    if (item.dataset.type === "threat") {
        score += 10;
        updatePanel();
        askQuestion(item);
    } else {
        score -= 5;
        updatePanel();
    }

    item.remove();
}

// SHOW QUESTION -------------------------------------
function askQuestion(item) {
    gameRunning = false;

    let qData = JSON.parse(item.dataset.question);
    let box = document.getElementById("questionBox");

    box.innerHTML = `<h3>${qData.q}</h3>`;

    qData.options.forEach((opt, i) => {
        let div = document.createElement("div");
        div.classList.add("option");
        div.innerHTML = opt;

        div.onclick = () => {
            if (i === qData.correct) {
                score += 5;
                alert("Correct!");
            } else {
                score -= 3;
                alert("Incorrect!");
            }

            box.style.display = "none";
            gameRunning = true;
            updatePanel();
        };

        box.appendChild(div);
    });

    box.style.display = "block";
}

function endGame() {
    gameRunning = false;
    clearInterval(gameInterval);
    clearInterval(timerInterval);
    alert("Game Over! Final Score: " + score);
}
</script>

</body>
</html>
